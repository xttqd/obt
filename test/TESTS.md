# Тесты смарт-контракта Dice

В этом каталоге содержатся три файла с тестами, каждый из которых тестирует контракт Dice с разных точек зрения и с использованием различных подходов к тестированию.

## Базовый тест (Dice.test.js)

Простой базовый тест, который проверяет основную функциональность контракта:
- Проверка корректной инициализации менеджера при деплое
- Проверка работы функции CEO для смены менеджера

## Комплексные сценарии (Dice.variant1.test.js)

Тесты, фокусирующиеся на сложных сценариях использования контракта:

### Access Control
- Проверка установки начального менеджера
- Проверка возможности смены менеджера для любого адреса

### Players Management
- Проверка инициализации пустого массива игроков
- Тестирование множественных последовательных смен менеджера
- Проверка сохранения корректного состояния после серии изменений

### Events and State
- Стресс-тест с быстрыми последовательными сменами менеджера
- Проверка корректности состояния после множественных изменений

## BDD подход (Dice.variant2.test.js)

Тесты, написанные в стиле Behavior Driven Development (BDD), с подробным описанием каждого сценария:

### Initialization
- Проверка корректной инициализации менеджера
- Проверка инициализации пустого массива игроков

### Manager Role
- Тестирование передачи роли менеджера через функцию CEO
- Проверка множественных последовательных смен менеджера
- Верификация корректности состояния после каждой смены

### Edge Cases (Граничные случаи)
- Проверка смены менеджера на тот же адрес
- Тестирование сохранения роли менеджера после неудачных операций

## Особенности реализации

1. **Подготовка окружения:**
   - Использование `beforeEach` для свежего развертывания контракта перед каждым тестом
   - Получение тестовых аккаунтов через `ethers.getSigners()`

2. **Проверки:**
   - Использование `expect` из библиотеки Chai для assertions
   - Проверка адресов и состояний контракта
   - Верификация корректности работы модификаторов доступа

3. **Тестовые сценарии:**
   - От простых проверок до сложных последовательностей действий
   - Охват граничных случаев и потенциальных проблем
   - Проверка корректности состояния после каждой операции

## Покрытие функциональности

Тесты охватывают следующие аспекты контракта:
- ✅ Деплой контракта
- ✅ Управление менеджером
- ✅ Работа с массивом игроков
- ✅ Проверка модификаторов доступа
- ✅ Граничные случаи
- ✅ Множественные транзакции

## Запуск тестов

Для запуска всех тестов используйте команду:
```bash
npx hardhat test
```

Для запуска конкретного файла с тестами:
```bash
npx hardhat test test/Dice.test.js
npx hardhat test test/Dice.variant1.test.js
npx hardhat test test/Dice.variant2.test.js
``` 